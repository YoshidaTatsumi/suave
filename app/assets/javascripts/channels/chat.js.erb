$(function() {
  const app = App.cable.subscriptions.create({channel: 'ChatChannel', room_id: $('.room').data('room') }, {
    connected: function(data) {
    },
    disconnected: function(data) {
    },
    received(data) {
      if ($('.room').data('user') == "admin") {
        $('.message').append(data['data_admin']);
      } else {
        $('.message').append(data['data_user']);
      }
    }
  })
  $(document).on('keypress', '.post', function(e) {
    if (e.keyCode === 13) {
      app.perform("speak", {data: $('.post').val(), send_user: $('.room').data('user'), current_user_id: $('.room').data('id')});
      $('.post').val('');
    }
  })
})
