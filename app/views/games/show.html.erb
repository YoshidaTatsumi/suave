<% if flash[:notice] %>
	<div class="row flash">
		<%= flash[:notice] %>
	</div>
<% end %>
<% if @comment.errors.any? %>
	<h2><%= @comment.errors.count %>
		 errors prohibited this obj from being saved:
	</h2>
	<ul>
		<% @comment.errors.full_messages.each do |message| %>
			<li><%= message %></li>
		<% end %>
	</ul>
<% end %>

<div class="row">
	<% if @game.user.id == current_user.id %>
		<%= link_to "ゲーム編集", edit_game_path(@game), class:"col-xs-2 col-xs-offset-6 btn btn-info", style:"margin-top:20px;" %>
		<%= link_to "スクリーンショット編集", edit_game_screenshots_path(@game), class:"col-xs-2 col-xs-offset-1 btn btn-info", style:"margin-top:20px;" %>
	<% end %>
</div>


<div class="row">
	<div class="col-xs-6">
		<h2><%= @game.title %></h2>
		<h3 class="game-author">作者：<%= link_to @game.user.name, user_path(@game.user) %></h3>

		<div class="row">
			<div class="col-xs-4 difficuty-box">
				<h4>難易度</h4>
				<div class="difficult-box-value">
					<% if @game.difficulty != nil %>
						<h4><%= @game.difficulty.round(1) %> / 100</h4>
						<% if @game.difficulty >= 80 %>
							<p>鬼畜！</p>
						<% elsif @game.difficulty >= 70 %>
							<p>難しい</p>
						<% elsif @game.difficulty >= 40 %>
							<p>普通</p>
						<% else %>
							<p>簡単</p>
						<% end %>
					<% else %>
						<h4>未評価</h4>
					<% end %>
				</div>
			</div>

			<div class="col-xs-4 col-xs-offset-1 rating-box">
				<h4>評価</h4>
				<div class="rating-box-value">
					<% if @game.rating != nil %>
						<h4><%= @game.rating.round(1) %> / 10</h4>
						<% if @game.rating >= 8 %>
							<p>神ゲー！</p>
						<% elsif @game.rating >= 6 %>
							<p>良ゲー</p>
						<% else %>
							<p>クソゲー</p>
						<% end %>
					<% else %>
						<h4>未評価</h4>
					<% end %>
				</div>
			</div>
		</div>
		<div class="row">
			<%= link_to "ダウンロードはこちら", @game.url, class:"download" %>
		</div>
		<div class="row">
			<% @game.tag_list.each do |tag| %>
				<%= link_to search_path(tag: tag), class:"btn btn-primary game-tags" do %>
					<%= tag %>
				<% end %>
			<% end %>
		</div>
	</div>

	<div class="col-xs-6 game-sceenshots">
		<h3>スクリーンショット</h3>
		<div class="bxslider">
			<% @game.screenshots.each do |screenshot| %>
				<%= attachment_image_tag screenshot, :image,:fill, 1920, 1080, format: 'jpeg',fallback: "NoImage.jpg", size: "500x281" %>
			<% end %>
		</div>
	</div>
</div>

<div class="row">
	<h3 class="col-xs-3 page-header">このゲームについて</h3>
</div>

<%=raw @game.introduction %>

<div class="row">
	<h3 class="col-xs-3 page-header">コメントする</h3>
</div>
<%= form_with(model: [@game, @comment], remote: true) do |f| %>
	<div class="row">
		<div class="col-xs-3">
			<h3>難易度（１００点中）</h3>
			<%= f.number_field :difficulty, class:"form-control" %>
		</div>
		<div class="col-xs-3 col-xs-offset-1">
			<h3>評価（１０点中）</h3>
			<div class="row">
				<%= f.number_field :rating, class:"form-control" %>
			</div>
		</div>
	</div>

	<div class="row comment-field">
		<div class="col-xs-10">
			<%= f.text_area :comment, rows:'5', class: "form-control" %>
		</div>
		<div class="col-xs-2" style="margin-top: 80px;">
			<%= f.submit "送信", class: "btn btn-primary pull-left" %>
		</div>
	</div>
<% end %>

<table id="js-table-comment" class="table">
	<%= render 'comments/comments', game: @game %>
</table>


<script>
	$(function(){
	  $('.bxslider').bxSlider({
	    auto: true,           // 自動スライド
	    speed: 1000,          // スライドするスピード
	    moveSlides: 1,        // 移動するスライド数
	    pause: 5000,          // 自動スライドの待ち時間
	    maxSlides: 1,         // 一度に表示させる最大数
	    slideWidth: 500,      // 各スライドの幅
		randomStart: false,    // 最初に表示するスライドをランダムに設定
	    autoHover: true       // ホバー時に自動スライドを停止
	  });
	});
</script>


